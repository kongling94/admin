webpackJsonp([0],{"+g6m":function(a,t,e){"use strict";var o=e("zL8q"),n={name:"tableList",props:{tableHeader:{type:Array},tableData:{type:Array,default:[]},showControl:{type:Boolean,default:!1}},data:function(){return{page:1,pageSize:20,totalData:[],currentPageData:[]}},methods:{copyAddress:function(a,t){this.$copyText(t.link).then(function(a){Object(o.Message)({message:"复制成功",type:"success"})},function(a){Object(o.Message)({message:"复制失败",type:"error"})})},handleUpdata:function(a){this.$emit("updataDialog",a)},styleHeaderBg:function(a){a.row,a.rowIndex;return"background-color:#e7eff5;font-size:14px;font-weight:normal;color:#959595;"},styleRowBg:function(a){a.row,a.rowIndex;return"background-color:#f5f9fb;"},styleCell:function(a){a.row,a.rowIndex;return"font-size:14px;color:#959595;"},handleCurrentChange:function(a){var t=this.totalData,e=Math.floor(t/this.pageSize);return a=a>e?e:a,this.currentPageData=t.slice((a-1)*this.pageSize,a*this.pageSize)},initData:function(a){this.totalData=a}},watch:{currentPageData:function(a){this.currentPageData=a},tableData:function(a){this.initData(a),this.handleCurrentChange(1)}},created:function(){var a=this;setTimeout(function(){a.initData(a.tableData),a.handleCurrentChange(1)},1e3)},mounted:function(){}},i={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"tableList"},[e("el-table",{directives:[{name:"show",rawName:"v-show",value:a.tableData,expression:"tableData"}],staticStyle:{width:"100%"},attrs:{data:a.currentPageData,"header-cell-style":a.styleHeaderBg,"cell-style":a.styleCell,"row-class-name":a.styleRowBg}},[a._l(a.tableHeader,function(a){return e("el-table-column",{key:a.id,attrs:{prop:a.prop,label:a.label}})}),a._v(" "),a.showControl?e("el-table-column",{attrs:{prop:"handle",label:"操作",width:"200"},scopedSlots:a._u([{key:"default",fn:function(t){return[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){a.handleUpdata(t.row)}}},[a._v("版本更新")]),a._v(" "),e("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(e){a.copyAddress(t.$index,t.row)}}},[a._v("复制链接")])]}}])}):a._e()],2),a._v(" "),e("el-pagination",{staticClass:"pages",attrs:{background:"",layout:"prev, pager, next","page-size":20,total:a.totalData.length},on:{"current-change":a.handleCurrentChange}})],1)},staticRenderFns:[]};var s=e("VU/8")(n,i,!1,function(a){e("KSEv")},"data-v-3d6fead1",null);t.a=s.exports},"94QT":function(a,t){},KPly:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=e("+g6m"),n=e("Zrlr"),i=e.n(n),s=function a(t){i()(this,a),this.name=t.name,this.fileList=[{url:t.appversion[0].file,name:t.appversion[0].file}],this.app_id=t.appversion[0].app_id,this.content=t.appversion[0].content,this.version_name=t.appversion[0].version_name},l=e("zL8q"),r={name:"updataDialog",props:{showDialog:{type:Boolean,default:!1},dialogData:{type:Object},isUpdata:{type:Boolean,default:!1}},data:function(){return{labelPosition:"left",formRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:3,max:5,message:"长度在 3 到 5 个字符",trigger:"blur"}],version_name:[{required:!0,message:"请输入一个版本号",trigger:"blur"}],file:[{required:!0,message:"请选择需要文件",trigger:"change"}],content:[{required:!0,message:"请填写活动形式",trigger:"blur"}]},addFormData:{name:"",version_name:"",content:"",fileList:[{name:"",url:""}]}}},methods:{maxFile:function(a,t){console.log(a),console.log(t)},openDialog:function(){if(!this.isUpdata||!this.dialogData)return this.addFormData={name:"",version_name:"",content:""};this.addFormData=new s(this.dialogData)},submitForm:function(){this.$refs.upload.submit()},beforeUpload:function(a){var t=this,e=new FormData;e.append("file",a),e.append("app_id",this.addFormData.app_id),e.append("name",this.addFormData.name),e.append("version_name",this.addFormData.version_name),e.append("content",this.addFormData.content);var o=this.isUpdata?"admin/appversion/update":"/admin/appversion/add";this.$post(o,{data:e,headers:{"Content-Type":"multipart/form-data"}}).then(function(a){1===a.code&&(t.cancelDialog(),Object(l.Message)({type:"success",message:a.msg}),t.$emit("isUploaded"))}).catch(function(a){Object(l.Message)({type:"error",message:a.msg})})},cancelDialog:function(){this.addFormData={name:"",version_name:"",content:""},this.$emit("watchDialog")}},computed:{},created:function(){},mounted:function(){}},d={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"dialog"},[e("el-dialog",{ref:"addApplication",attrs:{title:a.isUpdata?"更新版本":"添加应用",visible:a.showDialog,width:"32%",rules:a.formRules,"before-close":a.cancelDialog,center:""},on:{"update:visible":function(t){a.showDialog=t},open:a.openDialog}},[e("el-form",{ref:"addFormData",staticClass:"formDialog",attrs:{"label-position":a.labelPosition,"label-width":"80px",model:a.addFormData}},[e("el-form-item",{attrs:{label:"应用名",prop:"name"}},[e("el-input",{attrs:{disabled:a.isUpdata,placeholder:"请输入名称"},model:{value:a.addFormData.name,callback:function(t){a.$set(a.addFormData,"name",t)},expression:"addFormData.name"}})],1),a._v(" "),e("el-form-item",{attrs:{label:"版本号",prop:"version_name"}},[e("el-input",{attrs:{placeholder:"请输入版本号"},model:{value:a.addFormData.version_name,callback:function(t){a.$set(a.addFormData,"version_name",t)},expression:"addFormData.version_name"}})],1),a._v(" "),e("el-form-item",{attrs:{label:"上传文件",prop:"file"}},[e("el-upload",{ref:"upload",staticClass:"uploadFile",attrs:{action:"","before-upload":a.beforeUpload,accept:".apk,.jpg",limit:1,"auto-upload":!1,"file-list":a.addFormData.fileList,"on-exceed":a.maxFile}},[e("el-button",{attrs:{size:"small",type:"primary"}},[a._v("点击上传")])],1)],1),a._v(" "),e("el-form-item",{attrs:{label:"版本说明",prop:"content"}},[e("el-input",{staticClass:"form_textarea",attrs:{type:"textarea",placeholder:"请输入更新内容"},model:{value:a.addFormData.content,callback:function(t){a.$set(a.addFormData,"content",t)},expression:"addFormData.content"}})],1)],1),a._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:a.cancelDialog}},[a._v("取 消")]),a._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:a.submitForm}},[a._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=e("VU/8")(r,d,!1,function(a){e("uz4e")},"data-v-7106a5a2",null).exports,p={name:"userInfo",components:{tablelist:o.a,updataDialog:c},data:function(){return{showDialog:!1,tableHeader:[{label:"UID",prop:"id"},{label:"APP名",prop:"name"},{label:"当前版本",prop:"appversion[0].version_name"},{label:"发布时间",prop:"create_time"},{label:"最近更新",prop:"appversion[0].create_time"},{label:"下载量",prop:"appversion[0].count"}],tableData:[],isUpdata:!1,dialogData:null}},methods:{_getData:function(){var a=this;this.$post("/admin/app").then(function(t){1===t.code&&(a.tableData=t.data.list)})},openDialog_add:function(){this.dialogData=null,this.isUpdata=!1,this.showDialog=!0},closeDialog:function(){this.showDialog=!1},updataDialog:function(a){this.isUpdata=!0,this.dialogData=a,this.showDialog=!0}},mounted:function(){this._getData()}},u={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"userinfo"},[e("el-row",{staticClass:"userinfo-title",attrs:{type:"flex",justify:"space-between"}},[e("el-col",{staticClass:"title_text",attrs:{span:12}},[e("span",[a._v("应用列表")])]),a._v(" "),e("el-col",{staticClass:"title_addBtn",attrs:{span:12}},[e("button",{staticClass:"el-button el-button--primary add-application",attrs:{type:"button"},on:{click:a.openDialog_add}},[a._v("添加应用")])])],1),a._v(" "),e("div",{staticClass:"userinfo-list"},[e("tablelist",{ref:"tableList",attrs:{tableHeader:a.tableHeader,tableData:a.tableData,showControl:!0},on:{updataDialog:a.updataDialog}})],1),a._v(" "),e("updataDialog",{attrs:{showDialog:a.showDialog,isUpdata:a.isUpdata,dialogData:a.dialogData},on:{watchDialog:a.closeDialog,isUploaded:a._getData}})],1)},staticRenderFns:[]};var m=e("VU/8")(p,u,!1,function(a){e("94QT")},"data-v-bf5c0442",null);t.default=m.exports},KSEv:function(a,t){},Zrlr:function(a,t,e){"use strict";t.__esModule=!0,t.default=function(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}},uz4e:function(a,t){}});